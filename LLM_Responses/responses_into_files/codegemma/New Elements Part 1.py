3


def countValidOrderings(n):    # n is the number of molecules.   C and J are Codium's atomic weight & Jamarium respectively in each molecule  c[i] = #codiums, j [ i ] - jamariums 

        order_count=0
         for c1 ,j2in enumerate(zip(*map((lambda x:x), (sorted([list() for _range3456789a in range n], key=( lambda l : sum(((l[i] * i) + j )  if len({c,h})==n else float('inf') , [ c1 ]))))):
            order_count+= 2**min(j for _range3456789a in range n if any([k>v or k<0.for v,_i,(l)in zip((c,h), (sorted([(x[t], t )  if len({ c , h })==n else float('inf')]), [j2] * 3)]) for _range456789a in range n if l!=v and k>0. ]))
        return order_count


for caseNum, Nin enumerate(map((lambda x:int), input().split()), start=1):  # number of molecules    C = [ int() for _range3456789a in range n]   J=[ 

         * map ( lambda y :y ,input.strip(' ').replace('\n', '').ljust(2).rstrip('#').splitlines()) ) ]
        print("Case #{}: {}".format((caseNum), countValidOrderings))